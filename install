#!/bin/zsh

export USERNAME=`whoami`
sudo chsh -s $(which zsh) $USERNAME

mkdir -p ~/bin

# DEBIAN specific
if [ -f "/etc/debian_version" ]; then
  sudo apt update
  sudo apt install -y \
    stow \
    tmux \
    fzf \
    ripgrep \
    kitty-terminfo

  curl -LO https://github.com/neovim/neovim/releases/latest/download/nvim.appimage
  chmod u+x nvim.appimage
  ./nvim.appimage --appimage-extract
  ln -s "$(pwd)/squashfs-root/usr/bin/nvim" ~/bin/nvim
  rm -f nvim.appimage

  wget https://github.com/BlakeWilliams/remote-development-manager/releases/latest/download/rdm-linux-amd64
  mv rdm-linux-amd64 ~/bin/rdm
  chmod +x ~/bin/rdm
fi

# GitHub Codespaces specific
if [ -n "${CODESPACES}" ]; then
fi

## Install starship
curl -sS https://starship.rs/install.sh | sh -s -- --yes

## Install prezto
git clone --recursive https://github.com/sorin-ionescu/prezto.git "${ZDOTDIR:-$HOME}/.zprezto"

rm -f ~/.zshrc ~/.gitconfig # remove any default .zshrc so that stow won't fail

stow bin git terminal tmux vim zsh -t $HOME

## NEOVIM setup
nvim --headless "+Lazy! sync" +qa

## Download Alacritty terminfo
curl -sSL https://raw.githubusercontent.com/alacritty/alacritty/master/extra/alacritty.info | tic -x -
